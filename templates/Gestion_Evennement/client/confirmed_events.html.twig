{% extends 'Gestion_Evennement/base.html.twig' %}

{% block title %}Confirmed Events - MeetNTrip{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('lib/animate/animate.min.css') }}">
    <link rel="stylesheet" href="{{ asset('lib/owlcarousel/assets/owl.carousel.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/style.css') }}">
{% endblock %}

{% block body %}
    <!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-border text-secondary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Spinner End -->

    <div class="container-xxl py-5">
        <div class="text-center mb-5 wow fadeInUp" data-wow-delay="0.1s">
            <h1 class="display-5 fw-bold text-success mb-3">
                <i class="bi bi-check-circle-fill me-2"></i>
                Event Confirmed
            </h1>
            <div class="d-flex justify-content-center">
                <div class="border-bottom border-3 border-success opacity-75" style="width: 200px"></div>
            </div>
        </div>

        <!-- Flash Messages -->
        {% for message in app.flashes('success') %}
            <div class="alert alert-success alert-dismissible fade show">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}

        {% for message in app.flashes('error') %}
            <div class="alert alert-danger alert-dismissible fade show">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}

        <!-- Events Grid -->
        <div class="row g-4 justify-content-center">
            {% if evenements is empty %}
                <div class="col-12 text-center py-5">
                    <div class="alert alert-success bg-soft-success border-0 py-5">
                        <i class="bi bi-calendar2-check display-1 text-success mb-4"></i>
                        <h2 class="text-dark mb-3">No Confirmed Events Yet</h2>
                        <p class="text-muted fs-5">Your approved events will appear here once confirmed</p>
                        <a href="{{ path('client_evenements') }}" class="btn btn-success px-5 py-2 mt-3">
                            <i class="bi bi-arrow-left-circle me-2"></i>
                            Add Events
                        </a>
                    </div>
                </div>
            {% else %}
                {% for event in evenements %}
                    <div class="col-lg-4 col-md-6 wow fadeInUp" data-wow-delay="0.2s">
                        <div class="card h-100 border-success border-2 hover-top">
                            <div class="position-relative overflow-hidden" style="height: 250px">
                                {% if event.imagePath %}
                                    <img src="{{ asset('uploads/events/' ~ event.imagePath) }}" 
                                         class="card-img-top object-fit-cover h-100"
                                         alt="{{ event.nom }}">
                                {% else %}
                                    <div class="card-img-top bg-success bg-opacity-10 h-100 d-flex align-items-center justify-content-center">
                                        <div class="text-center text-success">
                                            <i class="bi bi-calendar2-event-fill display-4"></i>
                                            <h3 class="mt-3">{{ event.nom }}</h3>
                                        </div>
                                    </div>
                                {% endif %}
                                <div class="position-absolute top-0 end-0 m-3">
                                    <span class="badge bg-success bg-gradient">{{ event.type }}</span>
                                </div>
                            </div>

                            <div class="card-body">
                                <h4 class="card-title fw-bold text-dark mb-3">{{ event.nom }}</h4>
                                
                                <div class="event-details mb-4">
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="bi bi-people-fill text-success me-2"></i>
                                        <span>{{ event.nombreInvite }} Guests</span>
                                    </div>
                                    
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="bi bi-geo-alt-fill text-success me-2"></i>
                                        <span>{{ event.lieuEvenement }}</span>
                                    </div>
                                    
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="bi bi-calendar2-range-fill text-success me-2"></i>
                                        <div>
                                            <small class="text-muted d-block">{{ event.dateDebut|date('M d') }}</small>
                                            <small class="text-muted">to {{ event.dateFin|date('M d, Y') }}</small>
                                        </div>
                                    </div>
                                    
                                    <div class="d-flex align-items-center">
                                        <i class="bi bi-cash-stack text-success me-2"></i>
                                        <span class="fw-bold">${{ event.budgetPrevu|number_format(0) }}</span>
                                    </div>
                                </div>
                                
                                <div class="d-grid gap-2">
                                    <a href="{{ path('app_evenement_show', {'id': event.id}) }}" 
                                       class="btn btn-success btn-hover-scale py-2">
                                        <i class="bi bi-eye-fill me-2"></i>
                                        View Details
                                    </a>
                                    <a href="{{ path('client_event_qrcode', {'id': event.id}) }}" 
                                       target="_blank"
                                       class="btn btn-outline-success btn-hover-scale py-2">
                                        <i class="bi bi-qr-code me-2"></i>
                                        Show QR Code
                                    </a>
                                    <a href="{{ path('client_event_download', {'id': event.id}) }}" 
                                       class="btn btn-outline-success btn-hover-scale py-2">
                                        <i class="bi bi-file-pdf me-2"></i>
                                        Download PDF
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>

    {# Add Filter Buttons #}
    <div class="mb-4 text-center">
        {% set eventTypes = {
            'All': null,
            'Conference': 'Conference',
            'Seminars & Workshops': 'Seminars & Workshops',
            'Trade Shows & Expos': 'Trade Shows & Expos',
            'Team-Building Events': 'Team-Building Events',
            'Product Launches': 'Product Launches',
            'Networking Events': 'Networking Events',
            'Award Ceremonies': 'Award Ceremonies'
        } %}
        
        <div class="btn-group flex-wrap" role="group">
            {% for label,value in eventTypes %}
                <a href="{{ path('client_evenements_confirmed', {'type': value}) }}" 
                   class="btn btn-outline-success {{ (currentFilter == value) or (value is null and currentFilter is null) ? 'active' : '' }}">
                    {{ label }}
                </a>
            {% endfor %}
        </div>
    </div>

 
         <script>
            // Initialize WOW.js
            new WOW().init();
            
            // Hide spinner after page loads
            window.addEventListener('load', function() {
                document.querySelector('#spinner').classList.remove('show');
            });
        </script>
    {% endblock %}
 